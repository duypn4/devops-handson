version: '3.7'
services:
  vote-svc:
    build:
      context: ./vote-svc
    image: vote-svc
    container_name: vote-svc
    restart: always
    depends_on:
    - redis

  backend-svc:
    build:
      context: ./backend-svc
    image: backend-svc
    container_name: backend-svc
    restart: always
    ports:
    - 8080:80
    depends_on:
    - redis
    - vote-svc

  frontend-svc:
    build:
      context: ./frontend-svc
    image: frontend-svc
    container_name: frontend-svc
    restart: always
    ports:
    - 80:80
    depends_on:
    - backend-svc

  redis:
    image: redis:7.2.1
    container_name: redis
    restart: always
    ports:
    - 6379:6379

  jaeger:
    image: jaegertracing/all-in-one:1.18
    container_name: jaeger
    restart: always
    environment:
    - COLLECTOR_ZIPKIN_HTTP_PORT=9411
    ports:
    - "5775:5775/udp"
    - "6831:6831/udp"
    - "6832:6832/udp"
    - 5778:5778
    - 16686:16686
    - 14268:14268
    - 14250:14250
    - 9411:9411